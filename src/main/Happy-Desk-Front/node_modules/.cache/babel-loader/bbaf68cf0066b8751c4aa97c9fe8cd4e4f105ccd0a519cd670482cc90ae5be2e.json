{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useNavigate,useLocation}from'react-router-dom';import logo from'../images/kccic.png';import mypage from'../images/person.png';import{useAuth}from'../components/AuthContext';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Header(){const[currentUser,setCurrentUser]=useState(null);const navigate=useNavigate();const{getUserInfo}=useAuth();const location=useLocation();useEffect(()=>{// 쿼리 파라미터로 받은 access token을 local storage에 저장\nconst token=searchParam('token');if(token){localStorage.setItem(\"access_token\",token);window.location.href=\"/\";}function searchParam(key){return new URLSearchParams(window.location.search).get(key);}// access token으로 서버에 사용자 정보 요청\nconst updateProfile=async()=>{const user=await getUserInfo();if(user){setCurrentUser(user);}else{setCurrentUser(null);}};updateProfile();// 컴포넌트 마운트 시 호출\nwindow.addEventListener(\"loginSuccess\",updateProfile);// 사용자 정의 이벤트 리스너 추가\nreturn()=>{window.removeEventListener(\"loginSuccess\",updateProfile);// 컴포넌트 언마운트 시 리스너 제거\n};},[location,getUserInfo]);const goToHome=()=>{navigate('/');};const goLogin=()=>{navigate('/login');};const goMypage=()=>{navigate('/mypage');};// 로그아웃\nconst goLogout=()=>{localStorage.removeItem('access_token');document.cookie='refresh_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';window.location.href='/';};return/*#__PURE__*/_jsxs(\"div\",{className:\"header\",children:[/*#__PURE__*/_jsx(\"img\",{src:logo,className:\"logo\",alt:\"logo\"}),currentUser?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"mypage-icons\",children:[/*#__PURE__*/_jsxs(\"div\",{onClick:goMypage,children:[currentUser?/*#__PURE__*/_jsx(\"img\",{src:currentUser.avatarUrl,className:\"avatar\",alt:\"inter-avatar\"}):/*#__PURE__*/_jsx(\"img\",{src:mypage,className:\"mypage-icon\",alt:\"mypage-icon\"}),/*#__PURE__*/_jsx(\"div\",{children:currentUser.name})]}),/*#__PURE__*/_jsx(\"div\",{className:\"h-loginout\",onClick:goLogout,children:\"\\uB85C\\uADF8\\uC544\\uC6C3\"})]})}):/*#__PURE__*/_jsx(\"div\",{className:\"h-login\",onClick:goLogin,children:\"\\uB85C\\uADF8\\uC778\"}),/*#__PURE__*/_jsx(\"div\",{className:\"title\",onClick:goToHome,children:\"Happy Desk\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text\",children:\"\\uD3EC\\uC2A4\\uD2B8\\uC787\\uC73C\\uB85C \\uBA54\\uBAA8\\uB97C \\uB0A8\\uACA8\\uBCF4\\uC138\\uC694!\"})]});}export default Header;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","useLocation","logo","mypage","useAuth","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Header","currentUser","setCurrentUser","navigate","getUserInfo","location","token","searchParam","localStorage","setItem","window","href","key","URLSearchParams","search","get","updateProfile","user","addEventListener","removeEventListener","goToHome","goLogin","goMypage","goLogout","removeItem","document","cookie","className","children","src","alt","onClick","avatarUrl","name"],"sources":["C:/Users/seeun/IdeaProjects/guest-book/src/main/Happy-Desk-Front-main/src/components/Header.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport logo from '../images/kccic.png';\r\nimport mypage from '../images/person.png';\r\nimport { useAuth } from '../components/AuthContext';\r\n\r\nfunction Header() {\r\n  const [currentUser, setCurrentUser] = useState(null);\r\n  const navigate = useNavigate();\r\n  const { getUserInfo } = useAuth();\r\n  const location = useLocation();\r\n\r\n  useEffect(() => {\r\n\r\n    // 쿼리 파라미터로 받은 access token을 local storage에 저장\r\n    const token = searchParam('token');\r\n    if (token) {\r\n      localStorage.setItem(\"access_token\", token);\r\n      window.location.href = \"/\";\r\n    }\r\n\r\n    function searchParam(key) {\r\n      return new URLSearchParams(window.location.search).get(key);\r\n    }\r\n\r\n    // access token으로 서버에 사용자 정보 요청\r\n    const updateProfile = async () => {\r\n \r\n      const user = await getUserInfo();\r\n\r\n      if (user) {\r\n        setCurrentUser(user);\r\n\r\n      } else {\r\n        setCurrentUser(null);\r\n      }\r\n    };\r\n\r\n    updateProfile(); // 컴포넌트 마운트 시 호출\r\n    window.addEventListener(\"loginSuccess\", updateProfile); // 사용자 정의 이벤트 리스너 추가\r\n\r\n    return () => {\r\n      window.removeEventListener(\"loginSuccess\", updateProfile); // 컴포넌트 언마운트 시 리스너 제거\r\n    };\r\n  }, [location, getUserInfo]);\r\n\r\n  const goToHome = () => {\r\n    navigate('/');\r\n  };\r\n\r\n  const goLogin = () => {\r\n    navigate('/login');\r\n  };\r\n\r\n  const goMypage = () => {\r\n    navigate('/mypage');\r\n  };\r\n\r\n  // 로그아웃\r\n  const goLogout = () => {\r\n    localStorage.removeItem('access_token');\r\n    document.cookie = 'refresh_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';\r\n    window.location.href = '/';\r\n};\r\n\r\n  return (\r\n    <div className='header'>\r\n      <img src={logo} className='logo' alt=\"logo\" />\r\n      {\r\n        currentUser ?\r\n\r\n          <><div className='mypage-icons'>\r\n            <div onClick={goMypage}>\r\n              {\r\n                currentUser ?\r\n                  <img src={currentUser.avatarUrl} className='avatar' alt=\"inter-avatar\" />\r\n                  : <img src={mypage} className='mypage-icon' alt=\"mypage-icon\" />\r\n              }\r\n              <div>{currentUser.name}</div>\r\n            </div>\r\n            \r\n            <div className='h-loginout' onClick={goLogout}>로그아웃</div>\r\n            </div>\r\n            \r\n          </>\r\n          : <div className='h-login' onClick={goLogin}>로그인</div>\r\n      }\r\n\r\n      <div className='title' onClick={goToHome}>\r\n        Happy Desk\r\n      </div>\r\n      <div className='text'>포스트잇으로 메모를 남겨보세요!</div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Header;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}